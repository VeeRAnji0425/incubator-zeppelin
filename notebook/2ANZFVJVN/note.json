{
  "paragraphs": [
    {
      "text": "%md\n\nPOC Top10 temps réel avec Spark\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432643936631_1144984450",
      "id": "20150526-143856_1348030855",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch1\u003ePOC Top10 temps réel avec Spark\u003c/h1\u003e\n"
      },
      "dateCreated": "May 26, 2015 2:38:56 PM",
      "dateStarted": "May 26, 2015 2:40:22 PM",
      "dateFinished": "May 26, 2015 2:40:24 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Reset data",
      "text": "import com.datastax.spark.connector._\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.rdd.RDD\nimport org.joda.time.DateTime\nimport org.joda.time.Days\nimport org.joda.time.format.DateTimeFormat\n\nval universes \u003d Seq((\"VOD\",\"VOD\"),(\"TV\",\"TV\"),(\"CATCHUP\",\"CATCHUP\"),(\"ALL\",\"ALL\"))\nval timeslots \u003d Seq((\"MORNING\",\"MORNING\"),(\"NIGHT\",\"NIGHT\"),(\"NOON\",\"NOON\"),(\"AFTERNOON\",\"AFTERNOON\"),(\"PRIMETIME\",\"PRIMETIME\"),(\"ALL\",\"ALL\"))\nval wishes \u003d (1 to 32).map(wish \u003d\u003e (wish.toString,wish.toString)).toSeq :+ (\"ALL\",\"ALL\")\nval themes \u003d (1 to 10).map(theme \u003d\u003e (theme.toString,theme.toString)).toSeq :+ (\"ALL\",\"ALL\")\nval formats \u003d Seq((\"Movie\",\"Movie\"),(\"TV_Show\",\"TV_Show\"),(\"Documentary\",\"Documentary\"),(\"ALL\",\"ALL\"))\n//val dateFormat \u003d new java.text.SimpleDateFormat(\"yyyy-MM-dd\")\nval dateFormat \u003d DateTimeFormat.forPattern(\"yyyy-MM-dd\");",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true,
        "editorHide": true,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432645294531_-2061061381",
      "id": "20150526-150134_34607984",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import com.datastax.spark.connector._\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.rdd.RDD\nimport org.joda.time.DateTime\nimport org.joda.time.Days\nimport org.joda.time.format.DateTimeFormat\nuniverses: Seq[(String, String)] \u003d List((VOD,VOD), (TV,TV), (CATCHUP,CATCHUP), (ALL,ALL))\ntimeslots: Seq[(String, String)] \u003d List((MORNING,MORNING), (NIGHT,NIGHT), (NOON,NOON), (AFTERNOON,AFTERNOON), (PRIMETIME,PRIMETIME), (ALL,ALL))\nwishes: scala.collection.immutable.Seq[(String, String)] \u003d Vector((1,1), (2,2), (3,3), (4,4), (5,5), (6,6), (7,7), (8,8), (9,9), (10,10), (11,11), (12,12), (13,13), (14,14), (15,15), (16,16), (17,17), (18,18), (19,19), (20,20), (21,21), (22,22), (23,23), (24,24), (25,25), (26,26), (27,27), (28,28), (29,29), (30,30), (31,31), (32,32), (ALL,ALL))\nthemes: scala.collection.immutable.Seq[(String, String)] \u003d Vector((1,1), (2,2), (3,3), (4,4), (5,5), (6,6), (7,7), (8,8), (9,9), (10,10), (ALL,ALL))\nformats: Seq[(String, String)] \u003d List((Movie,Movie), (TV_Show,TV_Show), (Documentary,Documentary), (ALL,ALL))\ndateFormat: org.joda.time.format.DateTimeFormatter \u003d org.joda.time.format.DateTimeFormatter@63fb1a3d\n"
      },
      "dateCreated": "May 26, 2015 3:01:34 PM",
      "dateStarted": "May 26, 2015 5:52:24 PM",
      "dateFinished": "May 26, 2015 5:52:45 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Search data",
      "text": "\nvar result:RDD[(String,Long)] \u003d sc.parallelize(Nil) \nval fromDate \u003d dateFormat.parseDateTime(z.input(\"DateFrom\",\"2014-12-01\").toString)\n(0 to Days.daysBetween(fromDate,dateFormat.parseDateTime(z.input(\"DateTo\",\"2014-12-02\").toString)).getDays()).\nforeach{ increment \u003d\u003e {\n        val partial \u003d sc.cassandraTable(\"analytics\",\"watches_for_content\").\n        where(s\"\"\"universe\u003d\u0027${z.select(\"Universe\",\"VOD\",universes)}\u0027 AND timeslot\u003d\u0027${z.select(\"Timeslot\",\"MORNING\",timeslots)}\u0027 AND wish\u003d\u0027${z.select(\"Wish\",\"19\",wishes)}\u0027 AND theme\u003d\u0027${z.select(\"Theme\",\"ALL\",themes)}\u0027 AND format\u003d\u0027${z.select(\"Format\",\"ALL\",formats)}\u0027 AND day\u003d\u0027${dateFormat.print(fromDate.plusDays(increment))}\u0027\"\"\").\n        map(row \u003d\u003e {\n            (row.getString(\"content_name\"),row.getLong(\"score\"))\n        })\n        \n        result \u003d result.union(partial).reduceByKey{case(left,right) \u003d\u003e left+right}\n    }\n} \nresult \u003d sc.parallelize(result.sortBy(couple \u003d\u003e couple._2,false,1).take(10))",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "editorHide": false,
        "title": true
      },
      "settings": {
        "params": {
          "Day(YYYY-MM-DD)": "2014-12-02",
          "Universe": "ALL",
          "Timeslot": "AFTERNOON",
          "Format": "ALL",
          "Theme": "ALL",
          "Wish": "19",
          "From": "2014-12-01",
          "To": "2014-12-02",
          "DateFrom": "2014-12-01",
          "DateTo": "2014-12-01"
        },
        "forms": {
          "DateFrom": {
            "name": "DateFrom",
            "displayName": "DateFrom",
            "defaultValue": "2014-12-01",
            "hidden": false
          },
          "DateTo": {
            "name": "DateTo",
            "displayName": "DateTo",
            "defaultValue": "2014-12-02",
            "hidden": false
          },
          "Universe": {
            "name": "Universe",
            "displayName": "Universe",
            "defaultValue": "",
            "options": [
              {
                "value": "VOD",
                "displayName": "VOD"
              },
              {
                "value": "TV",
                "displayName": "TV"
              },
              {
                "value": "CATCHUP",
                "displayName": "CATCHUP"
              },
              {
                "value": "ALL",
                "displayName": "ALL"
              }
            ],
            "hidden": false
          },
          "Timeslot": {
            "name": "Timeslot",
            "displayName": "Timeslot",
            "defaultValue": "",
            "options": [
              {
                "value": "MORNING",
                "displayName": "MORNING"
              },
              {
                "value": "NIGHT",
                "displayName": "NIGHT"
              },
              {
                "value": "NOON",
                "displayName": "NOON"
              },
              {
                "value": "AFTERNOON",
                "displayName": "AFTERNOON"
              },
              {
                "value": "PRIMETIME",
                "displayName": "PRIMETIME"
              },
              {
                "value": "ALL",
                "displayName": "ALL"
              }
            ],
            "hidden": false
          },
          "Wish": {
            "name": "Wish",
            "displayName": "Wish",
            "defaultValue": "",
            "options": [
              {
                "value": "1",
                "displayName": "1"
              },
              {
                "value": "2",
                "displayName": "2"
              },
              {
                "value": "3",
                "displayName": "3"
              },
              {
                "value": "4",
                "displayName": "4"
              },
              {
                "value": "5",
                "displayName": "5"
              },
              {
                "value": "6",
                "displayName": "6"
              },
              {
                "value": "7",
                "displayName": "7"
              },
              {
                "value": "8",
                "displayName": "8"
              },
              {
                "value": "9",
                "displayName": "9"
              },
              {
                "value": "10",
                "displayName": "10"
              },
              {
                "value": "11",
                "displayName": "11"
              },
              {
                "value": "12",
                "displayName": "12"
              },
              {
                "value": "13",
                "displayName": "13"
              },
              {
                "value": "14",
                "displayName": "14"
              },
              {
                "value": "15",
                "displayName": "15"
              },
              {
                "value": "16",
                "displayName": "16"
              },
              {
                "value": "17",
                "displayName": "17"
              },
              {
                "value": "18",
                "displayName": "18"
              },
              {
                "value": "19",
                "displayName": "19"
              },
              {
                "value": "20",
                "displayName": "20"
              },
              {
                "value": "21",
                "displayName": "21"
              },
              {
                "value": "22",
                "displayName": "22"
              },
              {
                "value": "23",
                "displayName": "23"
              },
              {
                "value": "24",
                "displayName": "24"
              },
              {
                "value": "25",
                "displayName": "25"
              },
              {
                "value": "26",
                "displayName": "26"
              },
              {
                "value": "27",
                "displayName": "27"
              },
              {
                "value": "28",
                "displayName": "28"
              },
              {
                "value": "29",
                "displayName": "29"
              },
              {
                "value": "30",
                "displayName": "30"
              },
              {
                "value": "31",
                "displayName": "31"
              },
              {
                "value": "32",
                "displayName": "32"
              },
              {
                "value": "ALL",
                "displayName": "ALL"
              }
            ],
            "hidden": false
          },
          "Theme": {
            "name": "Theme",
            "displayName": "Theme",
            "defaultValue": "",
            "options": [
              {
                "value": "1",
                "displayName": "1"
              },
              {
                "value": "2",
                "displayName": "2"
              },
              {
                "value": "3",
                "displayName": "3"
              },
              {
                "value": "4",
                "displayName": "4"
              },
              {
                "value": "5",
                "displayName": "5"
              },
              {
                "value": "6",
                "displayName": "6"
              },
              {
                "value": "7",
                "displayName": "7"
              },
              {
                "value": "8",
                "displayName": "8"
              },
              {
                "value": "9",
                "displayName": "9"
              },
              {
                "value": "10",
                "displayName": "10"
              },
              {
                "value": "ALL",
                "displayName": "ALL"
              }
            ],
            "hidden": false
          },
          "Format": {
            "name": "Format",
            "displayName": "Format",
            "defaultValue": "",
            "options": [
              {
                "value": "Movie",
                "displayName": "Movie"
              },
              {
                "value": "TV_Show",
                "displayName": "TV_Show"
              },
              {
                "value": "Documentary",
                "displayName": "Documentary"
              },
              {
                "value": "ALL",
                "displayName": "ALL"
              }
            ],
            "hidden": false
          }
        }
      },
      "jobName": "paragraph_1432644022931_93724573",
      "id": "20150526-144022_628234026",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "result: org.apache.spark.rdd.RDD[(String, Long)] \u003d ParallelCollectionRDD[11] at parallelize at \u003cconsole\u003e:33\nfromDate: org.joda.time.DateTime \u003d 2014-12-01T00:00:00.000+01:00\nresult: org.apache.spark.rdd.RDD[(String, Long)] \u003d ParallelCollectionRDD[20] at parallelize at \u003cconsole\u003e:34\n"
      },
      "dateCreated": "May 26, 2015 2:40:22 PM",
      "dateStarted": "May 26, 2015 5:54:30 PM",
      "dateFinished": "May 26, 2015 5:54:35 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Top 10 most watched movies",
      "text": "result.displayAsTable(\"Content Name\",\"Count\")",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "multiBarChart",
          "height": 345.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "Content Name",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "Count",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "Content Name",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "Count",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "editorHide": true,
        "title": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432644569482_-1661899459",
      "id": "20150526-144929_1436401771",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "Content Name\tCount\n22 Jump Street\t26\nLet\u0027s Be Cops\t22\nThe Big Bang Theory\t21\nTeenage Mutant Ninja Turtles\t17\nTammy\t16\nRio 2\t13\nMr. Peabody \u0026 Sherman\t13\nNeighbors\t10\nIllumination 7 Mini-Movie Collection\t9\nTyler Perry\u0027s A Madea Christmas\t8\n"
      },
      "dateCreated": "May 26, 2015 2:49:29 PM",
      "dateStarted": "May 26, 2015 5:54:39 PM",
      "dateFinished": "May 26, 2015 5:54:39 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432644656567_1246356180",
      "id": "20150526-145056_959779493",
      "dateCreated": "May 26, 2015 2:50:56 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "POC-Spideo Top10 temps reel",
  "id": "2ANZFVJVN",
  "angularObjects": {},
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}