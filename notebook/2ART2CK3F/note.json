{
  "paragraphs": [
    {
      "text": "%md\n\nReading data from Cassandra\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432125137469_650840895",
      "id": "20150520-143217_474596748",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch1\u003eReading data from Cassandra\u003c/h1\u003e\n"
      },
      "dateCreated": "May 20, 2015 2:32:17 PM",
      "dateStarted": "May 20, 2015 2:33:38 PM",
      "dateFinished": "May 20, 2015 2:33:39 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n\n**Many ways to read data from Cassandra**:\n\n1. using plain **CassandraRDD[CassandraRow]**\n2. converting **CassandraRow** columns into **tuples**\n3. using **Scala case classes** with the integrated **object mapper**",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432125218563_-1408664128",
      "id": "20150520-143338_1132207280",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cp\u003e\u003cstrong\u003eMany ways to read data from Cassandra\u003c/strong\u003e:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eusing plain \u003cstrong\u003eCassandraRDD[CassandraRow]\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003econverting \u003cstrong\u003eCassandraRow\u003c/strong\u003e columns into \u003cstrong\u003etuples\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eusing \u003cstrong\u003eScala case classes\u003c/strong\u003e with the integrated \u003cstrong\u003eobject mapper\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n"
      },
      "dateCreated": "May 20, 2015 2:33:38 PM",
      "dateStarted": "May 20, 2015 2:35:15 PM",
      "dateFinished": "May 20, 2015 2:35:15 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Reading data using plain CassandraRow",
      "text": "import org.apache.spark.SparkContext._\nimport com.datastax.spark.connector._\n\nsc.cassandraTable(\"spark_demo\", \"us_unemployment_stats\").\n    map( row \u003d\u003e (row.getInt(\"year\"),row.getDouble(\"unemployed_percentage_to_labor\"))).\n    display(\"Year\",\"Unemployment Percentage\")",
      "dateUpdated": "Sep 23, 2015 10:47:46 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "Year",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "Unemployment Percentage",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "Year",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "Unemployment Percentage",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "tableHide": true,
        "title": true,
        "editorHide": false,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432125315541_2118499250",
      "id": "20150520-143515_1959047089",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "Year\tUnemployment Percentage\n1942\t4.7\n1944\t1.2\n1992\t7.5\n1999\t4.2\n1971\t5.9\n1953\t2.9\n1976\t7.7\n1982\t9.7\n1981\t7.6\n1954\t5.5\n1965\t4.5\n1983\t9.6\n2003\t6.0\n1952\t3.0\n1945\t1.9\n1972\t5.6\n1988\t5.5\n1978\t6.1\n2009\t9.3\n1995\t5.6\n2010\t9.6\n2005\t5.1\n2006\t4.6\n1960\t5.5\n1950\t5.3\n1979\t5.8\n1951\t3.3\n1962\t5.5\n1967\t3.8\n1968\t3.6\n2007\t4.6\n1955\t4.4\n1998\t4.5\n2001\t4.7\n2002\t5.8\n1969\t3.5\n1974\t5.6\n1990\t5.6\n2000\t4.0\n1977\t7.1\n1964\t5.2\n1984\t7.5\n1985\t7.2\n1989\t5.3\n1941\t9.9\n1943\t1.9\n1958\t6.8\n1957\t4.3\n1991\t6.8\n1993\t6.9\n1949\t5.9\n1996\t5.4\n1959\t5.5\n1994\t6.1\n1963\t5.7\n1946\t3.9\n2004\t5.5\n1970\t4.9\n1947\t3.9\n1966\t3.8\n1973\t4.9\n1961\t6.7\n1956\t4.1\n1987\t6.2\n1980\t7.1\n1986\t7.0\n1948\t3.8\n1997\t4.9\n2008\t5.8\n1975\t8.5\n"
      },
      "dateCreated": "May 20, 2015 2:35:15 PM",
      "dateStarted": "Sep 23, 2015 10:37:35 AM",
      "dateFinished": "Sep 23, 2015 10:37:39 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "read data using scala tuples",
      "text": "import org.apache.spark.SparkContext._\nimport com.datastax.spark.connector._\n\nsc.cassandraTable(\"spark_demo\", \"us_unemployment_stats\").\n    select(\"year\", \"unemployed_percentage_to_labor\").\n    as((_: Int, _: Double)).\n    sortByKey().\n    display(\"Year\",\"Unemployment Percentage\")",
      "dateUpdated": "Sep 23, 2015 10:48:03 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "Year",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "Unemployment Percentage",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "Year",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "Unemployment Percentage",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "title": true,
        "editorHide": false,
        "tableHide": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432126014638_1008677629",
      "id": "20150520-144654_1348217378",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "Year\tUnemployment Percentage\n1941\t9.9\n1942\t4.7\n1943\t1.9\n1944\t1.2\n1945\t1.9\n1946\t3.9\n1947\t3.9\n1948\t3.8\n1949\t5.9\n1950\t5.3\n1951\t3.3\n1952\t3.0\n1953\t2.9\n1954\t5.5\n1955\t4.4\n1956\t4.1\n1957\t4.3\n1958\t6.8\n1959\t5.5\n1960\t5.5\n1961\t6.7\n1962\t5.5\n1963\t5.7\n1964\t5.2\n1965\t4.5\n1966\t3.8\n1967\t3.8\n1968\t3.6\n1969\t3.5\n1970\t4.9\n1971\t5.9\n1972\t5.6\n1973\t4.9\n1974\t5.6\n1975\t8.5\n1976\t7.7\n1977\t7.1\n1978\t6.1\n1979\t5.8\n1980\t7.1\n1981\t7.6\n1982\t9.7\n1983\t9.6\n1984\t7.5\n1985\t7.2\n1986\t7.0\n1987\t6.2\n1988\t5.5\n1989\t5.3\n1990\t5.6\n1991\t6.8\n1992\t7.5\n1993\t6.9\n1994\t6.1\n1995\t5.6\n1996\t5.4\n1997\t4.9\n1998\t4.5\n1999\t4.2\n2000\t4.0\n2001\t4.7\n2002\t5.8\n2003\t6.0\n2004\t5.5\n2005\t5.1\n2006\t4.6\n2007\t4.6\n2008\t5.8\n2009\t9.3\n2010\t9.6\n"
      },
      "dateCreated": "May 20, 2015 2:46:54 PM",
      "dateStarted": "Sep 23, 2015 10:38:11 AM",
      "dateFinished": "Sep 23, 2015 10:38:12 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Read data using scala case class",
      "text": "import org.apache.spark.SparkContext._\nimport com.datastax.spark.connector._\n\ncase class UsUnemploymentRate(year: Int, unemployedPercentageToLabor: Double)\n\nsc.cassandraTable[UsUnemploymentRate](\"spark_demo\", \"us_unemployment_stats\").\n    sortBy(bean \u003d\u003e bean.year,true,1).\n    map(bean \u003d\u003e (bean.year,bean.unemployedPercentageToLabor)).\n    display(\"Year\",\"Unemployment Percentage\")",
      "dateUpdated": "Sep 23, 2015 10:48:13 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "Year",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "Unemployment Percentage",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "Year",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "Unemployment Percentage",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "title": true,
        "tableHide": true,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1433842506554_-1567680288",
      "id": "20150609-113506_374130940",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "Year\tUnemployment Percentage\n1941\t9.9\n1942\t4.7\n1943\t1.9\n1944\t1.2\n1945\t1.9\n1946\t3.9\n1947\t3.9\n1948\t3.8\n1949\t5.9\n1950\t5.3\n1951\t3.3\n1952\t3.0\n1953\t2.9\n1954\t5.5\n1955\t4.4\n1956\t4.1\n1957\t4.3\n1958\t6.8\n1959\t5.5\n1960\t5.5\n1961\t6.7\n1962\t5.5\n1963\t5.7\n1964\t5.2\n1965\t4.5\n1966\t3.8\n1967\t3.8\n1968\t3.6\n1969\t3.5\n1970\t4.9\n1971\t5.9\n1972\t5.6\n1973\t4.9\n1974\t5.6\n1975\t8.5\n1976\t7.7\n1977\t7.1\n1978\t6.1\n1979\t5.8\n1980\t7.1\n1981\t7.6\n1982\t9.7\n1983\t9.6\n1984\t7.5\n1985\t7.2\n1986\t7.0\n1987\t6.2\n1988\t5.5\n1989\t5.3\n1990\t5.6\n1991\t6.8\n1992\t7.5\n1993\t6.9\n1994\t6.1\n1995\t5.6\n1996\t5.4\n1997\t4.9\n1998\t4.5\n1999\t4.2\n2000\t4.0\n2001\t4.7\n2002\t5.8\n2003\t6.0\n2004\t5.5\n2005\t5.1\n2006\t4.6\n2007\t4.6\n2008\t5.8\n2009\t9.3\n2010\t9.6\n"
      },
      "dateCreated": "Jun 9, 2015 11:35:06 AM",
      "dateStarted": "Sep 23, 2015 10:39:37 AM",
      "dateFinished": "Sep 23, 2015 10:39:40 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Read data using sparkSQL programmatically",
      "text": "import org.apache.spark.sql.cassandra.CassandraSQLContext\n\nval cc \u003d new CassandraSQLContext(sc)\n\nval row \u003d cc.cassandraSql(s\"SELECT year,unemployed_percentage_to_labor \" +\n                                     s\"FROM spark_demo.us_unemployment_stats WHERE unemployed_percentage_to_labor \u003e 8 \" +\n                                     s\"ORDER BY year DESC\")\nrow.\n    map(row \u003d\u003e (row.getInt(0),row.getDouble(1))).\n    sortBy{case(year,_) \u003d\u003e year}.\n    display(\"Year\",\"Unemployment Percentage\")\n",
      "dateUpdated": "Sep 23, 2015 10:44:38 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "Year",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "Unemployment Percentage",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "Year",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "Unemployment Percentage",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "title": true,
        "tableHide": false,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432126280851_1108867753",
      "id": "20150520-145120_1566314701",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "Year\tUnemployment Percentage\n1941\t9.9\n1975\t8.5\n1982\t9.7\n1983\t9.6\n2009\t9.3\n2010\t9.6\n"
      },
      "dateCreated": "May 20, 2015 2:51:20 PM",
      "dateStarted": "Sep 23, 2015 10:41:53 AM",
      "dateFinished": "Sep 23, 2015 10:41:57 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Register Cassandra table into DataFrame",
      "text": "sqlContext\n  .read\n  .format(\"org.apache.spark.sql.cassandra\")\n  .options(Map(\"keyspace\" -\u003e \"spark_demo\", \"table\" -\u003e \"us_unemployment_stats\"))\n  .load()\n  .registerTempTable(\"us_unemployment_stats\")\n\n",
      "dateUpdated": "Sep 23, 2015 10:46:35 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "keyword",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "interval",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "keyword",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "interval",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432125656671_-542517733",
      "id": "20150520-144056_1766733826",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": ""
      },
      "dateCreated": "May 20, 2015 2:40:56 PM",
      "dateStarted": "Sep 23, 2015 10:46:35 AM",
      "dateFinished": "Sep 23, 2015 10:46:40 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Display using SparkSQL",
      "text": "%sql\nSELECT year,unemployed_percentage_to_labor\nFROM us_unemployment_stats \nWHERE unemployed_percentage_to_labor \u003e 8 \nORDER BY year ASC",
      "dateUpdated": "Sep 23, 2015 10:47:33 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true,
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1437400112265_-103467212",
      "id": "20150720-154832_1356318778",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "year\tunemployed_percentage_to_labor\n1941\t9.9\n1975\t8.5\n1982\t9.7\n1983\t9.6\n2009\t9.3\n2010\t9.6\n"
      },
      "dateCreated": "Jul 20, 2015 3:48:32 PM",
      "dateStarted": "Sep 23, 2015 10:47:33 AM",
      "dateFinished": "Sep 23, 2015 10:47:35 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1442998053869_373680540",
      "id": "20150923-104733_1188924077",
      "dateCreated": "Sep 23, 2015 10:47:33 AM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "02-Reading Data from Cassandra",
  "id": "2ART2CK3F",
  "angularObjects": {
    "2ARKVF46K": [],
    "2ANYRH787": [],
    "2AQBHNCAB": [],
    "2ANRWDJG1": [],
    "2ANNAMCUB": [],
    "2ARR8D6R9": [],
    "2AQAS485Z": []
  },
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}