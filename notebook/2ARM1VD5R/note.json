{
  "paragraphs": [
    {
      "text": "%md\n\nHow to use SparkSQL for analytics\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\n### I am not a developer, and I still want to use the **Cassandra/Spark** plateform",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432055381634_1511349703",
      "id": "20150519-190941_901589394",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch1\u003eHow to use SparkSQL for analytics\u003c/h1\u003e\n\u003ch3\u003eI am not a developer, and I still want to use the \u003cstrong\u003eCassandra/Spark\u003c/strong\u003e plateform\u003c/h3\u003e\n"
      },
      "dateCreated": "May 19, 2015 7:09:41 PM",
      "dateStarted": "Jul 23, 2015 12:30:41 AM",
      "dateFinished": "Jul 23, 2015 12:30:41 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "prepare data",
      "text": "import org.apache.spark.{SparkConf, SparkContext}\nimport com.datastax.spark.connector._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.SchemaRDD\nimport org.apache.spark.sql.cassandra.CassandraSQLContext\n\nval cc \u003d new CassandraSQLContext(sc)\n\ndef computeDecade(year:Int):String \u003d {\n    s\"${(year/10)*10}-${((year/10)+1)*10}\"\n}\n\ncc.udf.register(\"computeDecade\",computeDecade _)\n",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true,
        "editorHide": true,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432482039662_-1172636874",
      "id": "20150524-174039_852332121",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import org.apache.spark.{SparkConf, SparkContext}\nimport com.datastax.spark.connector._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.SchemaRDD\nimport org.apache.spark.sql.cassandra.CassandraSQLContext\ncc: org.apache.spark.sql.cassandra.CassandraSQLContext \u003d org.apache.spark.sql.cassandra.CassandraSQLContext@e16ce70\ncomputeDecade: (year: Int)String\nres92: org.apache.spark.sql.UserDefinedFunction \u003d UserDefinedFunction(\u003cfunction1\u003e,StringType)\n"
      },
      "dateCreated": "May 24, 2015 5:40:39 PM",
      "dateStarted": "Jul 23, 2015 12:30:45 AM",
      "dateFinished": "Jul 23, 2015 12:30:48 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Albums Releases group By Decade",
      "text": "cc.sql(s\"\"\"\n    SELECT computeDecade(a.year),p.country,count(a.title)\n    FROM spark_demo.performers p JOIN spark_demo.albums a\n    ON p.name \u003d a.performer\n    WHERE p.country is not null\n    AND p.country !\u003d \u0027Unknown\u0027\n    AND a.year \u003e\u003d 1900\n    GROUP BY computeDecade(a.year),p.country\n    HAVING count(a.title) \u003e ${z.input(\"Albums Count Threshold\",\"99999\")}\n\"\"\".stripMargin).\nmap(row \u003d\u003e (row.getString(0),row.getString(1),row.getLong(2))).\nsortBy[String](tuple \u003d\u003e tuple._1,true,1).\ndisplay(\"Decade\",\"Country\",\"Count\")\n\n\n",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "multiBarChart",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "Decade",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "Country",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "Decade",
              "index": 0.0,
              "aggr": "sum"
            }
          }
        },
        "editorHide": true,
        "tableHide": false,
        "title": true
      },
      "settings": {
        "params": {
          "countThreshold": "1000",
          "Albums Count Threshold": "250"
        },
        "forms": {
          "Albums Count Threshold": {
            "name": "Albums Count Threshold",
            "displayName": "Albums Count Threshold",
            "defaultValue": "99999",
            "hidden": false
          }
        }
      },
      "jobName": "paragraph_1431979407672_-74322143",
      "id": "20150518-220327_1132207280",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "Decade\tCountry\tCount\n1950-1960\tUSA\t637\n1960-1970\tUnited Kingdom\t509\n1960-1970\tUSA\t1445\n1970-1980\tUnited Kingdom\t1221\n1970-1980\tUSA\t1762\n1980-1990\tUnited Kingdom\t2817\n1980-1990\tGermany\t387\n1980-1990\tFrance\t296\n1980-1990\tJamaica\t269\n1980-1990\tUSA\t2800\n1990-2000\tSpain\t273\n1990-2000\tJapan\t1328\n1990-2000\tPoland\t283\n1990-2000\tNorway\t369\n1990-2000\tAustralia\t317\n1990-2000\tItaly\t450\n1990-2000\tCanada\t553\n1990-2000\tJamaica\t415\n1990-2000\tUnited Kingdom\t3985\n1990-2000\tUSA\t7829\n1990-2000\tGermany\t1393\n1990-2000\tFinland\t485\n1990-2000\tSweden\t780\n1990-2000\tFrance\t470\n2000-2010\tBrazil\t356\n2000-2010\tTurkey\t253\n2000-2010\tUnited Kingdom\t5436\n2000-2010\tSpain\t514\n2000-2010\tGermany\t2560\n2000-2010\tJapan\t2573\n2000-2010\tRussian Federation\t293\n2000-2010\tFinland\t1326\n2000-2010\tSweden\t1792\n2000-2010\tAustralia\t646\n2000-2010\tFrance\t1098\n2000-2010\tItaly\t707\n2000-2010\tJamaica\t356\n2000-2010\tDenmark\t259\n2000-2010\tUSA\t13545\n2000-2010\tBelgium\t332\n2000-2010\tNetherlands\t498\n2000-2010\tPoland\t521\n2000-2010\tNorway\t760\n2000-2010\tCanada\t1348\n2010-2020\tJapan\t300\n2010-2020\tSweden\t374\n2010-2020\tCanada\t375\n2010-2020\tUSA\t3497\n2010-2020\tGermany\t500\n2010-2020\tFinland\t274\n2010-2020\tFrance\t271\n2010-2020\tUnited Kingdom\t967\n"
      },
      "dateCreated": "May 18, 2015 10:03:27 PM",
      "dateStarted": "Jul 23, 2015 12:31:15 AM",
      "dateFinished": "Jul 23, 2015 12:32:21 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432416390614_-1432612695",
      "id": "20150523-232630_1520927567",
      "dateCreated": "May 23, 2015 11:26:30 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "06-Cassandra SparkSQL Analytics",
  "id": "2ARM1VD5R",
  "angularObjects": {
    "2ANYRH787": [],
    "2AQBHNCAB": [],
    "2ANRWDJG1": [],
    "2ANNAMCUB": [],
    "2ARR8D6R9": [],
    "2AQAS485Z": []
  },
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}