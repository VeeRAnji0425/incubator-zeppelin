{
  "paragraphs": [
    {
      "text": "%md\n\nHow to use SparkSQL for analytics\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nI am not a developer, and I still want to use the **Cassandra/Spark** plateform",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432055381634_1511349703",
      "id": "20150519-190941_901589394",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch1\u003eHow to use SparkSQL for analytics\u003c/h1\u003e\n\u003cp\u003eI am not a developer, and I still want to use the \u003cstrong\u003eCassandra/Spark\u003c/strong\u003e plateform\u003c/p\u003e\n"
      },
      "dateCreated": "May 19, 2015 7:09:41 PM",
      "dateStarted": "May 20, 2015 4:26:43 PM",
      "dateFinished": "May 20, 2015 4:26:43 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Reset data",
      "text": "import org.apache.spark.{SparkConf, SparkContext}\nimport com.datastax.spark.connector._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.SchemaRDD\nimport org.apache.spark.sql.cassandra.CassandraSQLContext\n\nvar rows:RDD[(String,String,Long)] \u003d sc.parallelize(Nil)\n\nval cc \u003d new CassandraSQLContext(sc)\n\ndef computeDecade(year:Int):String \u003d {\n    s\"${(year/10)*10}-${((year/10)+1)*10}\"\n}\n\ncc.registerFunction(\"computeDecade\", computeDecade _)",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true,
        "editorHide": true,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432482039662_-1172636874",
      "id": "20150524-174039_852332121",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import org.apache.spark.{SparkConf, SparkContext}\nimport com.datastax.spark.connector._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.SchemaRDD\nimport org.apache.spark.sql.cassandra.CassandraSQLContext\nrows: org.apache.spark.rdd.RDD[(String, String, Long)] \u003d ParallelCollectionRDD[85] at parallelize at \u003cconsole\u003e:85\ncc: org.apache.spark.sql.cassandra.CassandraSQLContext \u003d org.apache.spark.sql.cassandra.CassandraSQLContext@2c45f17c\ncomputeDecade: (year: Int)String\n"
      },
      "dateCreated": "May 24, 2015 5:40:39 PM",
      "dateStarted": "Jun 1, 2015 10:06:20 PM",
      "dateFinished": "Jun 1, 2015 10:06:24 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Compute Data",
      "text": "rows \u003d cc.cassandraSql(s\"\"\"\n        SELECT computeDecade(a.year),p.country,count(a.title)\n        FROM spark_demo.performers p JOIN spark_demo.albums a\n        ON p.name \u003d a.performer\n        WHERE p.country is not null\n        AND p.country !\u003d \u0027Unknown\u0027\n        AND a.year \u003e\u003d 1900\n        GROUP BY computeDecade(a.year),p.country\n        HAVING count(a.title) \u003e ${z.input(\"Albums Count Threshold\",\"250\")}\n      \"\"\".stripMargin).\n    map(row \u003d\u003e (row.getString(0),row.getString(1),row.getLong(2))).\n    sortBy[String](tuple \u003d\u003e tuple._1,true,1)\n",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": false,
        "tableHide": false,
        "title": true
      },
      "settings": {
        "params": {
          "countThreshold": "1000",
          "Albums Count Threshold": "500"
        },
        "forms": {
          "Albums Count Threshold": {
            "name": "Albums Count Threshold",
            "displayName": "Albums Count Threshold",
            "defaultValue": "250",
            "hidden": false
          }
        }
      },
      "jobName": "paragraph_1431979407672_-74322143",
      "id": "20150518-220327_1132207280",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "rows: org.apache.spark.rdd.RDD[(String, String, Long)] \u003d MappedRDD[50] at sortBy at \u003cconsole\u003e:63\n"
      },
      "dateCreated": "May 18, 2015 10:03:27 PM",
      "dateStarted": "May 28, 2015 4:34:54 PM",
      "dateFinished": "May 28, 2015 4:34:56 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Albums release by Decade",
      "text": "rows.displayAsTable(\"Decade\",\"Country\",\"Count\")",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 375.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "Decade",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "Decade",
              "index": 0.0,
              "aggr": "sum"
            }
          }
        },
        "title": true,
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1431983137464_-2085505932",
      "id": "20150518-230537_1766733826",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "Decade\n"
      },
      "dateCreated": "May 18, 2015 11:05:37 PM",
      "dateStarted": "Jun 1, 2015 10:06:26 PM",
      "dateFinished": "Jun 1, 2015 10:06:27 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432416390614_-1432612695",
      "id": "20150523-232630_1520927567",
      "dateCreated": "May 23, 2015 11:26:30 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "06-Cassandra SparkSQL Analytics",
  "id": "2ARM1VD5R",
  "angularObjects": {},
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}