{
  "paragraphs": [
    {
      "text": "%md\n\nHow to use Spark to copy data from old schema\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432130828543_-1202605713",
      "id": "20150520-160708_1993643854",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch1\u003eHow to use Spark to copy data from old schema\u003c/h1\u003e\n"
      },
      "dateCreated": "May 20, 2015 4:07:08 PM",
      "dateStarted": "May 20, 2015 4:08:01 PM",
      "dateFinished": "May 20, 2015 4:08:02 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nDepending on the partition key of the new schema, we may or may not have **perfect data locality**\n\nWe want to migrate data from\n\n```sql\nCREATE TABLE spark_demo.albums (\n    title text PRIMARY KEY,\n    country text,\n    performer text,\n    quality text,\n    status text,\n    year int\n)\n```\nto this new table\n\n```sql\nCREATE TABLE spark_demo.albums_by_country (\n    title text,\n    country text,\n    performer text,\n    quality text,\n    status text,\n    year int,\n    PRIMARY KEY((country,year),title)\n)\n```",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432130881795_-96929319",
      "id": "20150520-160801_427876585",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cp\u003eDepending on the partition key of the new schema, we may or may not have \u003cstrong\u003eperfect data locality\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eWe want to migrate data from\u003c/p\u003e\n\u003cpre\u003e\u003ccode class\u003d\"sql\"\u003eCREATE TABLE spark_demo.albums (\n    title text PRIMARY KEY,\n    country text,\n    performer text,\n    quality text,\n    status text,\n    year int\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eto this new table\u003c/p\u003e\n\u003cpre\u003e\u003ccode class\u003d\"sql\"\u003eCREATE TABLE spark_demo.albums_by_country (\n    title text,\n    country text,\n    performer text,\n    quality text,\n    status text,\n    year int,\n    PRIMARY KEY((country,year),title)\n)\n\u003c/code\u003e\u003c/pre\u003e\n"
      },
      "dateCreated": "May 20, 2015 4:08:01 PM",
      "dateStarted": "May 24, 2015 10:04:27 PM",
      "dateFinished": "May 24, 2015 10:04:29 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "truncate table albums_by_country",
      "text": "%cassandra\nTruncate spark_demo.albums_by_country;\n",
      "dateUpdated": "Sep 23, 2015 10:53:10 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true,
        "tableHide": true,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432130928531_-1930981353",
      "id": "20150520-160848_1834682060",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\n\n\u003cdiv class\u003d\"container\"\u003e\n\u003cdiv class\u003d\"row text-center\"\u003e\n\u003ch4\u003eNo Result\u003c/h4\u003e\n\u003c/div\u003e\n\u003cbr/\u003e\n    \u003cdiv class\u003d\"row\"\u003e\n    \u003cdiv class\u003d\"col-md-3\"\u003e\u003c/div\u003e\n    \u003cdiv class\u003d\"col-md-6 col-offset-md-3 table-responsive table-bordered\"\u003e\n        \u003ctable class\u003d\"table\"\u003e\n            \u003ccaption\u003e\u003ch5\u003eLast query execution info\u003c/h5\u003e\u003c/caption\u003e\n            \u003cthead\u003e\n                \u003ctr\u003e\n                    \u003cth\u003eInfo\u003c/th\u003e\n                    \u003cth\u003eValue\u003c/th\u003e\n                \u003c/tr\u003e\n            \u003c/thead\u003e\n            \u003ctbody\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eStatement\u003c/td\u003e\n                    \u003ctd\u003eTruncate spark_demo.albums_by_country;\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eAchieved Consistency\u003c/td\u003e\n                    \u003ctd\u003eN/A\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eTried Hosts\u003c/td\u003e\n                    \u003ctd\u003e127.0.0.1:9042\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eQueried Hosts\u003c/td\u003e\n                    \u003ctd\u003e127.0.0.1:9042\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eSchema In Agreement\u003c/td\u003e\n                    \u003ctd\u003etrue\u003c/td\u003e\n                \u003c/tr\u003e\n            \u003c/tbody\u003e\n        \u003c/table\u003e\n    \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "May 20, 2015 4:08:48 PM",
      "dateStarted": "Sep 23, 2015 10:53:05 AM",
      "dateFinished": "Sep 23, 2015 10:53:05 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Migrate data with spark",
      "text": "import scala.collection.JavaConversions._\nimport com.datastax.spark.connector._\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.{SparkConf, SparkContext}\n\ncase class Albums(title: String, country: String, performer:String, quality:Option[String],status:Option[String],year:Int)\n\nsc.cassandraTable[Albums](\"spark_demo\", \"albums\").saveToCassandra(\"spark_demo\",\"albums_by_country\")\n",
      "dateUpdated": "Sep 23, 2015 10:53:11 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "title": true,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432131174055_-2116093191",
      "id": "20150520-161254_1942103078",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import scala.collection.JavaConversions._\nimport com.datastax.spark.connector._\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.{SparkConf, SparkContext}\ndefined class Albums\n"
      },
      "dateCreated": "May 20, 2015 4:12:54 PM",
      "dateStarted": "Sep 23, 2015 10:53:11 AM",
      "dateFinished": "Sep 23, 2015 10:53:27 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Search Table Albums_by_country_and_year",
      "text": "%cassandra\nSELECT country,year,performer,title FROM spark_demo.albums_by_country\nWHERE country\u003d\u0027{{country\u003dGermany}}\u0027 AND year\u003d{{year\u003d2010}}\nLIMIT 100;",
      "dateUpdated": "Nov 3, 2015 10:41:56 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": true,
          "keys": [
            {
              "name": "country",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "year",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "country",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "year",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "title": true,
        "editorHide": false,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {
          "country": "Germany",
          "year": "2010"
        },
        "forms": {
          "country": {
            "name": "country",
            "displayName": "country",
            "defaultValue": "Germany",
            "hidden": false
          },
          "year": {
            "name": "year",
            "displayName": "year",
            "defaultValue": "2010",
            "hidden": false
          }
        }
      },
      "jobName": "paragraph_1432131588210_1727541219",
      "id": "20150520-161948_459128832",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "country\tyear\tperformer\ttitle\nGermany\t2010\tHellsongs\t2010-08-23: Nachtmix Bayerischer Rundfunk Munich Germany\nGermany\t2010\tBurnt Friedman \u0026 Jaki Liebezeit\t5 7\nGermany\t2010\tFaith and the Muse\t:ankoku butoh:\nGermany\t2010\tHenrik Schwarz\tA Critical Mass Live EP\nGermany\t2010\tWynardtage\tA Flicker of Hope\nGermany\t2010\tSopor Aeternus \u0026 The Ensemble of Shadows\tA Strange Thing to Say\nGermany\t2010\tGrossstadtgeflüster\tAlles muss man selber machen\nGermany\t2010\tAntimatter\tAlternative Matter\nGermany\t2010\tO Yuki Conjugate\tAmbiguism 1983-1987\nGermany\t2010\tBloody Dead and Sexy\tAn Eye on You\nGermany\t2010\tPara One\tAnimal Style / Nevrosis\nGermany\t2010\tThe Ocean\tAnthropocentric\nGermany\t2010\tLeaves’ Eyes\tAt Heaven\u0027s End\nGermany\t2010\tSND\tAtavism\nGermany\t2010\tEgotronic\tAusflug mit Freunden\nGermany\t2010\tLordi\tBabez for Breakfast\nGermany\t2010\tThe Sonic Boom Foundation\tBad News Always Good News\nGermany\t2010\tAudio Lotion\tBad Timing\nGermany\t2010\tJahcoozi\tBarefoot Wanderer\nGermany\t2010\tJahcoozi\tBarefoot Wanderer Remixes Part 1\nGermany\t2010\tMartyn\tBerghain 04 | Part I\nGermany\t2010\tDapayk Solo\tBerlin Bedlam\nGermany\t2010\tEight Legs\tBest of Me\nGermany\t2010\tIszoloscope\tBeyond Within\nGermany\t2010\tFjernlys\tBeyond the Undulant Quiescence\nGermany\t2010\tJapanische Kampfhörspiele\tBilder fressen Strom\nGermany\t2010\tFaderhead\tBlack Friday\nGermany\t2010\tConsole\tBlank Air / By This River\nGermany\t2010\tDJ Koze\tBlume Der Nacht / Rue Burnout\nGermany\t2010\tSAM\tBrainwasher\nGermany\t2010\tBloodbath\tBreeding Death\nGermany\t2010\tGOOSE\tCan\u0027t Stop Me Now\nGermany\t2010\tDiorama\tChild of Entertainment\nGermany\t2010\tThe Puppini Sisters\tChristmas With The Puppini Sisters\nGermany\t2010\tIris\tCloser to Real\nGermany\t2010\tClueso\tClueso \u0026 Stüba Philharmonie\nGermany\t2010\tSolitary Experiments\tCompendium 2\nGermany\t2010\tOjos de Brujo\tCorriente Vital: 10 Años\nGermany\t2010\tKoop\tCoup de Grâce 1997-2007\nGermany\t2010\tThe Sounds\tCrossing the Rubicon\nGermany\t2010\tDiorama\tCubed\nGermany\t2010\tCœur de pirate\tCœur de pirate\nGermany\t2010\tState of the Union\tDancing in the Dark\nGermany\t2010\tMagica\tDark Diary\nGermany\t2010\tCats on Fire\tDealing in Antiques\nGermany\t2010\tExciter\tDeath Machine\nGermany\t2010\tDapayk Solo\tDecade One\nGermany\t2010\tDeathstars\tDecade of Debauchery\nGermany\t2010\tRedman\tDef Jammable\nGermany\t2010\tAdversus\tDer Zeit abhanden\nGermany\t2010\tDaniel Kehlmann\tDer fernste Ort\nGermany\t2010\tMarcel Dettmann\tDettmann\nGermany\t2010\tMarcel Dettmann\tDettmann Remixed\nGermany\t2010\tMax Richter\tDie Fremde\nGermany\t2010\txotox\tDie Unruhe 2.0\nGermany\t2010\tReaper\tDirty Cash\nGermany\t2010\tSamy Deluxe\tDis wo ich herkomm Live\nGermany\t2010\tExtrawelt\tDistTheme\nGermany\t2010\tGentleman\tDiversity\nGermany\t2010\tOrdo Rosarius Equilibrio\tDo Angels Never Cry and Heaven Never Fall?\nGermany\t2010\tFormat:B\tDog Tag\nGermany\t2010\tEisbrecher\tEiszeit\nGermany\t2010\tMinor Majority\tEither Way I Think You Know\nGermany\t2010\tDino Saluzzi\tEl Encuentro\nGermany\t2010\tReamonn\tEleven\nGermany\t2010\tRuede Hagelstein\tEmergency / This Way\nGermany\t2010\tSaalschutz\tEntweder Saalschutz\nGermany\t2010\tBuddy Peace\tEquinox Presents: The 25th - The Equinox Megamixes\nGermany\t2010\tEluveitie\tEverything Remains as It Never Was\nGermany\t2010\tFrank Bretschneider\tExp\nGermany\t2010\tIsrael Kamakawiwoʻole\tFacing Future\nGermany\t2010\tBarbara Morgenstern\tFan No.2\nGermany\t2010\tMasterplan\tFar From the End of the World\nGermany\t2010\tFarben\tFarben EP\nGermany\t2010\tBombay Bicycle Club\tFlaws\nGermany\t2010\tKettcar\tFliegende Bauten\nGermany\t2010\t5F-X\tFlight Recorder 5.0\nGermany\t2010\tBurden of Grief\tFollow the Flames\nGermany\t2010\tLou Bega\tFree Again\nGermany\t2010\tBipol\tFritter Away\nGermany\t2010\tDapayk Solo\tFutu\nGermany\t2010\tMelchior Productions\tGentlemen Jack EP\nGermany\t2010\tMy Ruin\tGhosts and Good Stories\nGermany\t2010\tFehlfarben\tGlücksmaschinen\nGermany\t2010\tKollektiv Turmstrasse\tGrillen Im Park\nGermany\t2010\tThomas Fehlmann\tGute Luft\nGermany\t2010\tThomas Fehlmann\tGute Luft Remixe\nGermany\t2010\tDie Aeronauten\tHallo Leidenschaft!\nGermany\t2010\tPure Reason Revolution\tHammer and Anvil\nGermany\t2010\tGrand Magus\tHammer of the North\nGermany\t2010\tUntoten\tHaus der Lüge\nGermany\t2010\tVolbeat\tHeaven nor Hell\nGermany\t2010\tThe Ocean\tHeliocentric\nGermany\t2010\tThe Ocean\tHeliocentric / Anthropocentric\nGermany\t2010\tThe Big Bopper\tHello Baby! You Know What I Like!\nGermany\t2010\tPopNoName\tHello Gorgeous\nGermany\t2010\tConsole\tHerself\nGermany\t2010\tJan Delay\tHoffnung\nGermany\t2010\tKnorkator\tIch hasse Musik\nGermany\t2010\tTelefon Tel Aviv\tImmolate Yourself Remixes\n"
      },
      "dateCreated": "May 20, 2015 4:19:48 PM",
      "dateStarted": "Nov 3, 2015 10:41:56 AM",
      "dateFinished": "Nov 3, 2015 10:41:56 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432131634668_1347686786",
      "id": "20150520-162034_2044470361",
      "dateCreated": "May 20, 2015 4:20:34 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "06-Cassandra Spark For Schema Migration",
  "id": "2AR1MKVYA",
  "angularObjects": {
    "2ARKVF46K": [],
    "2ANYRH787": [],
    "2AQBHNCAB": [],
    "2ANRWDJG1": [],
    "2ANNAMCUB": [],
    "2ARR8D6R9": [],
    "2AQAS485Z": []
  },
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}