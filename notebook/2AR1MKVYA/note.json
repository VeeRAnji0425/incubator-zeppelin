{
  "paragraphs": [
    {
      "text": "%md\n\nHow to use Spark to copy data from old schema\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432130828543_-1202605713",
      "id": "20150520-160708_1993643854",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003ch1\u003eHow to use Spark to copy data from old schema\u003c/h1\u003e\n"
      },
      "dateCreated": "May 20, 2015 4:07:08 PM",
      "dateStarted": "May 20, 2015 4:08:01 PM",
      "dateFinished": "May 20, 2015 4:08:02 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nDepending on the partition key of the new schema, we may or may not have **perfect data locality**\n\nWe want to migrate data from\n\n```sql\nCREATE TABLE spark_demo.albums (\n    title text PRIMARY KEY,\n    country text,\n    performer text,\n    quality text,\n    status text,\n    year int\n)\n```\nto this new table\n\n```sql\nCREATE TABLE spark_demo.albums_by_country (\n    title text,\n    country text,\n    performer text,\n    quality text,\n    status text,\n    year int,\n    PRIMARY KEY((country,year),title)\n)\n```",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432130881795_-96929319",
      "id": "20150520-160801_427876585",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cp\u003eDepending on the partition key of the new schema, we may or may not have \u003cstrong\u003eperfect data locality\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eWe want to migrate data from\u003c/p\u003e\n\u003cpre\u003e\u003ccode class\u003d\"sql\"\u003eCREATE TABLE spark_demo.albums (\n    title text PRIMARY KEY,\n    country text,\n    performer text,\n    quality text,\n    status text,\n    year int\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eto this new table\u003c/p\u003e\n\u003cpre\u003e\u003ccode class\u003d\"sql\"\u003eCREATE TABLE spark_demo.albums_by_country (\n    title text,\n    country text,\n    performer text,\n    quality text,\n    status text,\n    year int,\n    PRIMARY KEY((country,year),title)\n)\n\u003c/code\u003e\u003c/pre\u003e\n"
      },
      "dateCreated": "May 20, 2015 4:08:01 PM",
      "dateStarted": "May 24, 2015 10:04:27 PM",
      "dateFinished": "May 24, 2015 10:04:29 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "truncate table albums_by_country",
      "text": "%cassandra\nTruncate spark_demo.albums_by_country;\n",
      "dateUpdated": "Sep 23, 2015 10:53:10 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "title": true,
        "tableHide": true,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432130928531_-1930981353",
      "id": "20150520-160848_1834682060",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\n\n\u003cdiv class\u003d\"container\"\u003e\n\u003cdiv class\u003d\"row text-center\"\u003e\n\u003ch4\u003eNo Result\u003c/h4\u003e\n\u003c/div\u003e\n\u003cbr/\u003e\n    \u003cdiv class\u003d\"row\"\u003e\n    \u003cdiv class\u003d\"col-md-3\"\u003e\u003c/div\u003e\n    \u003cdiv class\u003d\"col-md-6 col-offset-md-3 table-responsive table-bordered\"\u003e\n        \u003ctable class\u003d\"table\"\u003e\n            \u003ccaption\u003e\u003ch5\u003eLast query execution info\u003c/h5\u003e\u003c/caption\u003e\n            \u003cthead\u003e\n                \u003ctr\u003e\n                    \u003cth\u003eInfo\u003c/th\u003e\n                    \u003cth\u003eValue\u003c/th\u003e\n                \u003c/tr\u003e\n            \u003c/thead\u003e\n            \u003ctbody\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eStatement\u003c/td\u003e\n                    \u003ctd\u003eTruncate spark_demo.albums_by_country;\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eAchieved Consistency\u003c/td\u003e\n                    \u003ctd\u003eN/A\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eTried Hosts\u003c/td\u003e\n                    \u003ctd\u003e127.0.0.1:9042\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eQueried Hosts\u003c/td\u003e\n                    \u003ctd\u003e127.0.0.1:9042\u003c/td\u003e\n                \u003c/tr\u003e\n                \u003ctr\u003e\n                    \u003ctd\u003eSchema In Agreement\u003c/td\u003e\n                    \u003ctd\u003etrue\u003c/td\u003e\n                \u003c/tr\u003e\n            \u003c/tbody\u003e\n        \u003c/table\u003e\n    \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e"
      },
      "dateCreated": "May 20, 2015 4:08:48 PM",
      "dateStarted": "Sep 23, 2015 10:53:05 AM",
      "dateFinished": "Sep 23, 2015 10:53:05 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Migrate data with spark",
      "text": "import scala.collection.JavaConversions._\nimport com.datastax.spark.connector._\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.{SparkConf, SparkContext}\n\ncase class Albums(title: String, country: String, performer:String, quality:Option[String],status:Option[String],year:Int)\n\nsc.cassandraTable[Albums](\"spark_demo\", \"albums\").saveToCassandra(\"spark_demo\",\"albums_by_country\")\n",
      "dateUpdated": "Sep 23, 2015 10:53:11 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "tableHide": false,
        "title": true,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432131174055_-2116093191",
      "id": "20150520-161254_1942103078",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import scala.collection.JavaConversions._\nimport com.datastax.spark.connector._\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.{SparkConf, SparkContext}\ndefined class Albums\n"
      },
      "dateCreated": "May 20, 2015 4:12:54 PM",
      "dateStarted": "Sep 23, 2015 10:53:11 AM",
      "dateFinished": "Sep 23, 2015 10:53:27 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Search Table Albums_by_country_and_year",
      "text": "%cassandra\nUSE spark_demo;\n\nSELECT country,year,performer,title FROM albums_by_country\nWHERE country\u003d\u0027{{country\u003dGermany}}\u0027 AND year\u003d{{year\u003d2016}}\nLIMIT 100;",
      "dateUpdated": "Sep 23, 2015 10:54:09 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": true,
          "keys": [
            {
              "name": "country",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "year",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "groups": [],
          "scatter": {
            "xAxis": {
              "name": "country",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "year",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "title": true,
        "editorHide": false,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {
          "country": "Germany",
          "year": "2000"
        },
        "forms": {
          "country": {
            "name": "country",
            "displayName": "country",
            "defaultValue": "Germany",
            "hidden": false
          },
          "year": {
            "name": "year",
            "displayName": "year",
            "defaultValue": "2016",
            "hidden": false
          }
        }
      },
      "jobName": "paragraph_1432131588210_1727541219",
      "id": "20150520-161948_459128832",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "country\tyear\tperformer\ttitle\nGermany\t2000\tRednex\t...Farm Out!\nGermany\t2000\tKarl Bartos\t15 Minutes of Fame\nGermany\t2000\tNoisex\t1920.00\nGermany\t2000\tDestruction\t2 Originals of Destruction\nGermany\t2000\tNoisex\t2870.00 Box\nGermany\t2000\tCraig David\t7 Days\nGermany\t2000\tXPQ-21\tA Gothic Novel\nGermany\t2000\tNecrophagia\tA Legacy of Horror Gore and Sickness\nGermany\t2000\tKoxbox\tA Major Problem in Australia EP\nGermany\t2000\tDave Douglas\tA Thousand Evenings\nGermany\t2000\tOren Ambarchi\tAfternoon Tea\nGermany\t2000\tRank 1\tAirwave\nGermany\t2000\tDie Apokalyptischen Reiter\tAll You Need Is Love\nGermany\t2000\tXavier Naidoo\tAlles\nGermany\t2000\tKid Rock\tAmerican Bad Ass\nGermany\t2000\tGeoff White\tAnd They\u0027re Off\nGermany\t2000\tEtnica\tAndromeda EP\nGermany\t2000\tTarwater\tAnimals Suns \u0026 Atoms\nGermany\t2000\tHocico\tAquí y ahora en el silencio\nGermany\t2000\tDakar \u0026 Grinser\tAre You Really Satisfied Now\nGermany\t2000\tSteve Bug\tAt the Front\nGermany\t2000\tArovane\tAtol Scrap\nGermany\t2000\tAvantasia\tAvantasia\nGermany\t2000\tSteve Bug\tB Series Volume 1\nGermany\t2000\tAxxis\tBack to the Kingdom\nGermany\t2000\tCalexico\tBallad of Cable Hogue\nGermany\t2000\tSCSI-9\tBe So Good in the Fresh\nGermany\t2000\tFarben\tBeautone\nGermany\t2000\tNevermore\tBelieve in Nothing\nGermany\t2000\tXPQ-21\tBelle Epoque\nGermany\t2000\tMountain\tBest: Flowers of Evil\nGermany\t2000\tF.S. Blumm\tBettvanille Weiter\nGermany\t2000\tAlter Ego\tBetty Ford\nGermany\t2000\tBlank \u0026 Jones\tBeyond Time\nGermany\t2000\tPluramon\tBit Sand Riders\nGermany\t2000\tDeichkind\tBitte Ziehen Sie Durch\nGermany\t2000\tTanzwut\tBitte bitte\nGermany\t2000\tDeichkind\tBitte ziehen Sie durch\nGermany\t2000\tGeiom\tBlanket / Four Fifty Five\nGermany\t2000\tAutumnblaze\tBleak\nGermany\t2000\tT.Raumschmiere\tBolzplatz EP\nGermany\t2000\tDeichkind\tBon Voyage\nGermany\t2000\tTiefschwarz\tBoogie Wonderland 2K\nGermany\t2000\tBeginner\tBoombule: Bambule Remixed\nGermany\t2000\tAbsurd Minds\tBrainwash\nGermany\t2000\tS Club 7\tBring It All Back\nGermany\t2000\tdavaNtage\tBroken Influences\nGermany\t2000\tDoro\tBurn It Up\nGermany\t2000\tVNV Nation\tBurning Empires\nGermany\t2000\tPhilippe Cam\tCaddie\u0027s Day / Western\nGermany\t2000\tDoro\tCalling the Wild\nGermany\t2000\tMaroon\tCaptive in the Room of the Conspirator\nGermany\t2000\tTrüby Trio\tCarajillo / A Go Go\nGermany\t2000\tElectronicat\tCat A Tac\nGermany\t2000\tTommy Emmanuel\tChet Lag\nGermany\t2000\tChicks on Speed\tChix 52\nGermany\t2000\tCinema Strange\tCinema Strange\nGermany\t2000\tThe Tiger Lillies\tCircus Songs\nGermany\t2000\tInfected Mushroom\tClassical Mushroom\nGermany\t2000\tZeromancer\tClone Your Lover\nGermany\t2000\tDionysos\tCoccinelle / Wet\nGermany\t2000\tParadox\tCollision Course\nGermany\t2000\tAbsurd Minds\tCome Alive\nGermany\t2000\tConsole\tConsole Yourself\nGermany\t2000\tThomas Brinkmann\tCorvette\nGermany\t2000\tJosef K\tCrazy to Exist\nGermany\t2000\tGuano Apes\tCuts \u0026 Clips From Don’t Give Me Names\nGermany\t2000\tPaul Kalkbrenner\tDB+\nGermany\t2000\tBlank \u0026 Jones\tDJ Culture\nGermany\t2000\tKai Tracid\tDJ Mix Volume 2\nGermany\t2000\tDJ Shah\tDJ Shah\nGermany\t2000\tStereo MCs\tDJ‐Kicks: Stereo MC’s\nGermany\t2000\tFettes Brot\tDa draußen\nGermany\t2000\tKosmonova\tDanse Avec Moi\nGermany\t2000\tScore!\tDas ist erst der Anfang\nGermany\t2000\tEllen Allien\tDataromance\nGermany\t2000\tThe Crown\tDeathrace King\nGermany\t2000\tPierrepoint\tDeleted Tracks From Earth\nGermany\t2000\tTerry Pratchett\tDer fünfte Elefant\nGermany\t2000\tCarl Craig\tDesigner Music: The Remixes Volume 1\nGermany\t2000\tKai Tracid\tDestiny\u0027s Path\nGermany\t2000\tMax Raabe \u0026 Palast Orchester\tDie Hits des Jahres\nGermany\t2000\txotox\tDie Prophezeiung\nGermany\t2000\tAndré Rieu\tDie grössten Hits\nGermany\t2000\tJeans Team\tDing Dong\nGermany\t2000\txotox\tDisinhibition\nGermany\t2000\tDulce Liquido\tDisolución\nGermany\t2000\tElectric Universe\tDivine Design\nGermany\t2000\tDarkseed\tDiving Into Darkness\nGermany\t2000\tblackmail\tDo Robots Dream of Electric Sheep?\nGermany\t2000\tSpock’s Beard\tDon\u0027t Try This at Home\nGermany\t2000\tGuano Apes\tDon’t Give Me Names\nGermany\t2000\tSascha Funke\tDoppelpass\nGermany\t2000\tThe Associates\tDouble Hipness\nGermany\t2000\tScore!\tDu kannst mich mal\nGermany\t2000\tIlluminate\tDunkellicht\nGermany\t2000\tGuano Apes\tDödel Up\nGermany\t2000\tE Nomine\tE Nomine\nGermany\t2000\tMelotron\tE.P. Sode 3\nGermany\t2000\tTied \u0026 Tickled Trio\tEA1 EA2 Rmx\n"
      },
      "dateCreated": "May 20, 2015 4:19:48 PM",
      "dateStarted": "Sep 23, 2015 10:54:09 AM",
      "dateFinished": "Sep 23, 2015 10:54:09 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1432131634668_1347686786",
      "id": "20150520-162034_2044470361",
      "dateCreated": "May 20, 2015 4:20:34 PM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "04-Cassandra Spark For Schema Migration",
  "id": "2AR1MKVYA",
  "angularObjects": {
    "2ARKVF46K": [],
    "2ANYRH787": [],
    "2AQBHNCAB": [],
    "2ANRWDJG1": [],
    "2ANNAMCUB": [],
    "2ARR8D6R9": [],
    "2AQAS485Z": []
  },
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}